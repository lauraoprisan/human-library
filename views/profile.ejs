<%- include('partials/header') -%>
<div class="container">
  <div class="row mt-5">

<!--User info-->
      <div>
        <p><strong>User Name</strong>: <%= user.userName %></p>
        <a href="/logout" class="col-3 btn btn-primary">Logout</a>
      </div>
<!--/User info-->
<!--Add story-->
      <% if(!story) { %>
      <div class="col-6">
          <div class="mt-5">
            <h2>Add a story</h2>
            <form action="/story/createStory" enctype="multipart/form-data" method="POST" id="add-story">
              <div class="mb-3">
                  <label for="title" class="form-label">Title</label>
                  <input type="text" class="form-control" id="title" name="title">
              </div>
              <div class="mb-3">
                <label for="textContent" class="form-label">textContent</label>
                <textarea class="form-control" id="textContent" name="textContent"></textarea>
              </div>
              <div class="mb-3">
                <label for="imgUpload" class="form-label">Image</label>
                <input type="file" class="form-control" id="imageUpload" name="file">
              </div>
              <div class="mb-3">
                <label for="country" class="form-label">Country</label>
                <select name="country" id="country" class="form-control">
                  <option id="countryChoice" ></option>
                </select>  
              </div>
              <div class="mb-3">
                <label for="continent" class="form-label">Continent</label>
                <select name="continent" id="continent" class="form-control">
                  <option id="continentChoice"></option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary" value="Upload">Submit first story</button>
            </form>
          </div>
      </div>
    <% } %>
<!--/Add story-->
<!--edit story-->
<% if(editStory){ %>
  <div class="col-6">
      <div class="mt-5">
        <h2>Edit your story</h2>
        <form action="/updateStory/<%= story._id %>?_method=PUT"  method="POST">
          <div class="mb-3">
              <label for="newTitle" class="form-label">Title</label>
              <input type="text" class="form-control" id="title" name="newTitle" value="<%= story.title%>">
          </div>
          <div class="mb-3">
            <label for="newTextContent" class="form-label">textContent</label>
            <textarea class="form-control" id="textContent" name="newTextContent" wrap ><%= story.textContent%></textarea>
          </div>
          <!-- <div class="mb-3">
            <label for="imgUpload" class="form-label">Image</label>
            <input type="file" class="form-control" id="imageUpload" name="file" value="<%= story.image%>">
          </div> -->
          <div class="mb-3">
            <label for="newCountry" class="form-label">Country</label>
            <select name="newCountry" id="country" class="form-control"></select>
            <option id="countryChoice" value="<%= story.country%>"></option>
          </div>
          <div class="mb-3">
            <label for="newContinent" class="form-label">Continent</label>
            <select name="newContinent" id="continent" class="form-control"></select>
            <option id="continentChoice" value="<%= story.continent%>"></option>
          </div>
         
          <button type="submit" class="btn btn-primary" value="Upload">Save changes</button> 
        </form>
      </div>
  </div>
<% } %>
<!--/edit story-->


      <div class="col-6">
        <ul class="row list-unstyled">
        <% if(story){%>
          <li class="col-6 justify-content-between mt-5">
            <a href="/story/<%= story._id%>">
              <h2><%= story.title%></h2>
              <img class="img-fluid" src="<%= story.image%>">
              <p><%= story.textContent.split(" ").slice(0,30).join(" ")%>...</p>
            </a>
          </li>
        </ul>
          <div class="row justify-content-center mt-5">
            <a class="btn btn-primary" href="/editStory/<%= story._id%>">Edit story</a>
          </div>
        <% } %> 
        <div class="row justify-content-center mt-5">
          <a class="btn btn-primary" href="/favorites">See your favorites</a>
        </div> 
        <div class="row justify-content-center mt-5">
          <a class="btn btn-primary" href="/library">Read people's story</a>
        </div>  
      </div>  
    </div>
  </div>
</div>
<%- include('partials/footer') -%>